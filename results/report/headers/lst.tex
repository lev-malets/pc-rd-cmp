\usepackage[final]{listings}

\renewcommand\lstlistingname{Листинг}
\renewcommand\lstlistlistingname{Листинги}

\lstdefinelanguage{ocaml}{
    keywords={
        @type, function, fun, let, in, match, with, when, class, type,
        nonrec, object, method, of, rec, while, not, do, done, as, val, inherit, and,
        new, module, sig, deriving, datatype, struct, if, then, else, open, private, virtual, include,
        lazy, assert, true, false, end
    },
    sensitive=true,
    columns=fixed,
    mathescape=true,
    literate={->}{{$\to$}}3 {===}{{$\equiv$}}1 {=/=}{{$\not\equiv$}}1 {|>}{{$\triangleright$}}3 {\\/}{{$\vee$}}2 {/\\}{{$\wedge$}}2 {>=}{{$\ge$}}1 {<=}{{$\le$}} 1,
    literate={\$}{{\textcolor{blue}{\$}}}1,
    morecomment=[s]{(*}{*)},
}

\lstset{
    mathescape=true,
    basicstyle=\ttfamily,
    identifierstyle=,
    keywordstyle=\bfseries,
    commentstyle=\scriptsize\rmfamily,
    basewidth={0.5em,0.5em},
    fontadjust=true,
    language=ocaml
}

\DeclareCaptionFont{white}{ \color{white} }
\DeclareCaptionFormat{listing}{
    \parbox{\textwidth}{\hspace{15pt}#1#2#3}
}
\captionsetup[lstlisting]{
    format=listing,
    singlelinecheck=false,
    margin=0pt,
    font={bf}
}
